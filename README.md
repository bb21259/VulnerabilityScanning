# Vulnerability Scanning with Nessus

 Video up in the future...
 <br/>
 <img src="https://i.imgur.com/ld3j9H5.png" height="80%" width="80%" alt="TheOverview"/>

<h2>Description</h2>
In this lab, I use Tenable's vulnerability scanner, Nessus, to run a few variety of scans on a Windows VM. Purposefully I make the host vulnerable to demonstrate how Nessus is able to find and present these vulnerabilities to a user. Finally, I run through the remediations Nessus suggest to perform on the host to conclude.
<br />


<h2>Utilities Used</h2>

- <b>Nessus</b> 
- <b>VMware Workstation</b>


<h2>Environments Used </h2>

- <b>Windows 10 pro</b> 

<h2>Lab walk-through:</h2>

<p align="center">
Setting up a VM to scan: <br/>
<img src="https://i.imgur.com/HYnhjIk.png" height="80%" width="80%" alt="TheFirstStep"/>
<br />
<b>As the first step, I went ahead and installed VMware workstation but any virtualizion software is fine it is important to remember to set up a NAT and a bridged network adapter, the iso for Windows 10 is available on the Microsfot website.<b/>
<br/>
<br />
Ensuring connectivity:  <br/>
<img src="https://i.imgur.com/2j800nS.png" height="80%" width="80%" alt="TheOpenFWVUlStep"/>
<br />
<b>Next, I made sure the VM had its firewall opened up and confirmed by pinging it from my system. Then, if not already done, go through with installing Nessus and setting it up for use. <b/>
<br />
<br/>
A first scan: <br/>
<img src="https://i.imgur.com/xW0NQbc.png" height="80%" width="80%" alt="TheFirstScan"/>
<br />
<b>Selecting a basic network scan, the IP address of the VM is entered and a non-credential scan is run. If you are following along remember to have set this scan to "scan all ports".<b/>
<br />
<br />
Results of the first scan:  <br/>
<img src="https://i.imgur.com/8d6Zh3v.png" height="80%" width="80%" alt="TheFirstScanStep"/>
<br />
<b>The non-credenialed scan provides limited information but does mention the ports that were left open on the host.<b/>
<br />
<br/>
Setting up a credentialed scan:<br/>
<img src="https://i.imgur.com/6URYtBc.png" height="80%" width="80%" alt="ServicesStep"/>
<br />
<b>Now to run a credentialed scan a few changes must be made to the host to allow this to be done remotely. Here, the remote registry service is enabled. Also user account control should be set to never ask when making changes to the host. <b/>
<br />
<br/>
Setting up a credetenialed scan:  <br/>
<img src="https://i.imgur.com/x0UVCCo.png" height="80%" width="80%" alt="RedEditStep"/>
<br />
<b>Next, the remote registry must have a new DWORD created called "LocalAccountTokenFilterPolicy" in the folder path you can view in the image. Remember to set its value to 1.<b/>
 <br/>
 <br/>
 Running a credentialed scan:<br/>
<img src="https://i.imgur.com/eTwDSLg.png" height="80%" width="80%" alt="RUnCSStep"/>
 <br/>
<b>The next scan on Nessus is given the credentials and ran. As you can a lot more is revealed in this scan than the prior one.<b/>
<br/>
<br/>
Testing the scanner:<br/>
 <img src="https://i.imgur.com/LIJlY8V.png" height="80%" width="80%" alt="ADDINGVUlTESTStep"/>
 <br/>
<b>For this scan I purposely chose to add a vulnerability and to check if the vulnerability scanner is working properly and picks up on it. I chose to download an older version of Firefox but you may choose to go a different way with this. Anyway, the second credentialed scan reveals the additional vulnerabilty I added by downloading an out of date piece of software.<b/>
 <br/>
<br/>
Remediating a system:<br/>
<img src="https://i.imgur.com/PueOlol.png" height="80%" width="80%" alt="UnistallFFStep"/>
<br/>
Nessus provides us with a remediations tab which conveiniently list the severeness and priority a user shoud take when remediating a system. The Firefox one is listed first so that I took care of first. Although Nessus suggests to update Firefox I went ahead and simply unistalled it.<b/>
<br/>
<br/>
Remediating continued:  <br/>
<img src="https://i.imgur.com/0XSxrRF.png" height="80%" width="80%" alt="WindowsUpdatestep"/> <br/>
 <br/>
 Nessus also suggests the variety of different Windows updates that should be done so I perform this on the host aswell.<br/>
<br/> 
A scan to verify remediation:<br/>
<img src="https://i.imgur.com/NYCdBfG.png" height="80%" width="80%" alt="LAstScanStep"/>
<br/>
 After following the suggested remediations I run another scan to ensure these vulnerabilities are taken care of. Admittedly, I did not run through all the required suggsted Windows updates but for examples sake this last scan still reveals that following the suggested remediation has helped reduce vulnerabilities on this host.<b/>
<br />
</p>

<!--
 ```diff
- text in red
+ text in green
! text in orange
# text in gray
@@ text in purple (and bold)@@
```
--!>
